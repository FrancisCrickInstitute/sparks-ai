<!doctype html>

<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>SPARKS Documentation</title>
    <meta name="description" content="A simple HTML/CSS DocumentationTemplate">
    <meta name="author" content="Nicolas Skatchkovsky">

    <link rel="stylesheet" href="style.css?">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif:wght@400;700&family=Open+Sans:ital,wght@0,400;0,700;1,600&display=swap" rel="stylesheet">
    
    <script defer src="https://use.fontawesome.com/releases/v5.7.2/js/all.js" integrity="sha384-0pzryjIRos8mFBWMzSSZApWtPl/5++eIfzYmTgBBmXYdhvxPc+XcFEk+zJwDgWbP" crossorigin="anonymous"></script>

    <style>
      #code-block {
        background-color: #333; /* This is a dark gray color. You can use any color you prefer. */
        color: #fff; /* This is a white color for the text. You can use any color you prefer. */
        padding: 2px; /* This adds some padding around the text. You can adjust this value as needed. */
        border-radius: 2px; /* This creates rounded corners with a radius of 10 pixels. You can adjust this value as needed. */        
      }
    </style>

    <style>
      .big-code-block {
        background-color: #333;
        color: #fff;
        padding: 3px;
        border-radius: 1px;
        position: relative;
      }
      .copy-button {
        position: absolute;
        top: 10px;
        right: 10px;
        background-color: #fff;
        color: #333;
        border: none;
        padding: 5px 10px;
        border-radius: 5px;
        cursor: pointer;
      }
    </style>

</head>

<body>

    <div class="navbar clear nav-top">
        <div class="row content">
            <a class="right" style="text-decoration: underline;" href="https://github.com/franciscrickinstitute/sparks"><i class="fa-brands fa-github"></i></i>&nbsp; GitHub</a>
            <a class="right" style="text-decoration: underline;" href="https://franciscrickinstitute.github.io/sparks-ai/"><i class="fas fa-book"></i>&nbsp; Main page</a>
            <a class="right" href="mailto:nicolas.skatchkovsky[at]crick[dot]ac[dot]uk[dot]com" target="_blank"><i class="fas fa-paper-plane"></i>&nbsp; nicolas.skatchkovsky[at]crick[dot]ac[dot]uk[dot]com</a>
        </div>
    </div>

    <div class="container clear">
        <div class="row wrapper">

            <div class="sidepanel">

                <a class="title" href="#">Introduction</a>
                
                <a class="section" href="#">About this App</a>

                <div class="divider left"></div>

                <a class="title" href="#gettingstarted">Getting Started</a>

                <a class="section" href="#pipinstall">Installation with pip</a>
                <a class="section" href="#condainstall">Installation with conda</a>

                <div class="divider left"></div>

                <a class="title" href="#basicfeatures">Basic Features</a>

                <a class="section" href="#basicfeatures">Feature 1</a>
                <a class="section" href="#basicfeatures">Feature 2</a>
                <a class="section" href="#feature3">Feature 3</a>
                <a class="section" href="#feature3">Feature 4</a>
                <a class="section" href="#feature3">Feature 5</a>

                <div class="divider left"></div>

                <a class="title" href="#advanced">Advanced Features</a>

                <a class="section" href="#advanced">Feature A</a>
                <a class="section" href="#featureb">Feature B</a>
                <a class="section" href="#featurec">Feature C</a>
                <a class="sub-section" href="#featurec1">Feature C.1</a>
                <a class="sub-section" href="#featurec2">Feature C.2</a>
                <a class="section" href="#featured">Feature D</a>

                <div class="divider left"></div>

                <a class="title" href="#accesibility">Accesibility</a>

                <div class="divider left"></div>

                <a class="title" href="#moreinfo">More Info</a>
            
             <div class="space double"></div>

            </div>

            <div class="right-col">

                  <div class="container" style="width: 60%; margin-bottom: 20px;">
                     <img width="60%" src="static/images/logo_2.png" alt="Image description">
                 </div>

                <h1 >Introduction</h1>
                
                <p> This is the official documentation for SPARKS, a Sequential Predictive Autoencoder for the Representation of Spiking Signals. SPARKS combines a variational autoencoder with a novel Hebbian attention layer and predictive learning rule to obtain consistent latent embeddings that capture most of the variance from high dimensional neuronal responses. </p> 
            
                <h2>About this App</h2>
                
                <p id="technology"> SPARKS is built in python (v >= 3.9). using Pytorch. We provide high-level training/testing function to get quickly started, and users that are already familiar with Pytorch should be able to easily make full use of SPARKS. The following instructions were tested on a Linux server (Rocky Linux 8.7 Green Obsidian) with CUDA 12.2 and MacOS (Sonoma 14.5 with Apple M2 Max).</p>

                
        <div class="divider" style="width:24%; margin:30px 0;"></div>

                <h1 id="gettingstarted">Getting Started</h1>

                <h2>Installation</h2>
                
                <p>SPARKS can be installed via <code id="code-block">pip</code> or <code id="code-block">conda</code>.</p>
                
                <h3 id="pipinstall"> Installation with pip </h3>
                   <ol>
                    <li>
                     Create a new virtual environment by running
                     <div class="big-code-block">
                      <pre><code id="code">$ virtualenv .env && source .env/bin/activate</code></pre>
                      <button class="copy-button">Copy</button>
                    </div>
                    <script src="script.js"></script>
                    </li>
                    <br>
                    <li>
                     Depending on your systems requirements, you may want to install Pytorch manually, for instance to install the correct CUDA version (please see more details <a href="https://pytorch.org/get-started/locally/">here</a>) .
                    </li>
                    <br id="openingapp">
                    <li>
                     Install using conda: 
                     <div class="big-code-block">
                      <pre><code id="code">$ pip install sparks</code></pre>
                      <button class="copy-button">Copy</button>
                    </div>
                    <script src="script.js"></script>
                    </li>
                    <br>
                </ol>
                

                <h3 id= "condainstall"> Installation with conda</h3>
                   <ol>
                    <li>
                     Install Anaconda or Miniconda (please see more details <a href="https://docs.anaconda.com/anaconda/install/">here</a>).
                    </li>
                    <br>
                    <li>
                    Create a new conda environment by running
                    <div class="big-code-block">
                      <pre><code id="code">$ conda create -n sparks python==3.9
$ conda activate sparks</code></pre>
                      <button class="copy-button">Copy</button>
                    </div>
                    <script src="script.js"></script>
                    </li>
                    <li>
                     Depending on your systems requirements, you may want to install Pytorch manually, for instance to install the correct CUDA version (please see more details <a href="https://pytorch.org/get-started/locally/">here</a>) .
                    </li>
                    <br id="openingapp">
                    <li>
                     Install using conda: 
                     <div class="big-code-block">
                      <pre><code id="code">$ conda install sparks</code></pre>
                      <button class="copy-button">Copy</button>
                    </div>
                    <script src="script.js"></script>
                    </li>
                    <br>
                </ol>

                <p id="installingapp"><b>Important:</b> By default, <code id="code-block">sparks</code> is installed without the dependencies required to run scripts using the monkey reaching and Allen datasets (Chowdury et al., 2020, de Vries et al., 2020). To install the library with all dependencies, please run <code id="code-block"> pip install sparks[scripts]</code>. However, due to compatibility issues with the <code id="code-block">allen_sdk</code> library, we recommend installing it first from this <a href="https://allensdk.readthedocs.io">link</a>.</p>

            <div class="divider" style="width:24%; margin:30px 0;"></div>
            
            
                <h1 id="minimumexample">Minimum example</h1>
                
                <p> <code id="code-block">sparks</code> follows standard <a href="https://pytorch.org/">PyTorch</a> syntax, and scripts will often look like this:</p>
                <pre><div class="big-code-block">
train_dl = MyTrainDataLoader()
test_dl = MyTrainDataLoader()
encoding_network = HebbianTransformerEncoder(n_neurons_per_sess=n_neurons,  # number of neurons in the recording, or a list of numbers of neurons, one for each session
                                             embed_dim=embed_dim,  #  attention embedding dimension
                                             latent_dim=latent_dim,  # latent dimension
                                             tau_s_per_sess=tau_s,  # STDP decay in seconds, or a list of STDP decays, one per attention head
                                             dt_per_sess=dt,  # sampling period
                                             n_layers=n_layers,  # number of conventional attention layers
                                             n_heads=n_heads,  # number of attention heads,  
                                             ).to(device)
n_inputs_decoder = latent_dim * tau_p
decoding_network = mlp(in_dim=n_inputs_decoder,
                       hid_features=int(np.mean([n_inputs_decoder, input_size])),
                       output_dim_per_session=input_size).to(device)

optimizer = torch.optim.Adam(list(encoding_network.parameters())
                             + list(decoding_network.parameters()), lr=lr)
loss_fn = torch.nn.BCEWithLogitsLoss()


test_period = 1

for epoch in tqdm.tqdm(range(args.n_epochs)):
    train_iterator = iter(train_dl)
    train(encoder=encoding_network,
                   decoder=decoding_network,
                   train_dls=[train_dl],
                   loss_fn=loss_fn,
                   optimizer=optimizer,
                   latent_dim=latent_dim,
                   tau_p=tau_p,  # past time-steps window
                   tau_f=tau_f,  # future time-steps window
                   beta=beta,  # KLD regularisation strength
                   device=device)

    if (epoch + 1) % test_period == 0:
        test_loss, encoder_outputs, decoder_outputs = test(encoding_network,
                                                           decoding_network,
                                                           test_dl,
                                                           latent_dim=latent_dim,
                                                           tau_p=tau_p,
                                                           tau_f=tau_f,
                                                           loss_fn=loss_fn,
                                                           device=device,)</code></pre>
                      <button class="copy-button">Copy</button>
                    </div>
                    <script src="script.js"></script>

                <h2>Feature 2</h2>
                
                <p>
                Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.
                <br><br>
                <b>Explanation 1</b> Lorem ipsum dolor sit amet, consectetur adipiscing elit.
                <br>
                <br>
                <b>Explanation 2</b> Lorem ipsum dolor sit amet, consectetur adipiscing elit.
                <br>
                <br>
                <b>Explanation 3</b> Lorem ipsum dolor sit amet, consectetur adipiscing elit.
                <br>
                <br id="feature3">
                <b>Explanation 4</b> Lorem ipsum dolor sit amet, consectetur adipiscing elit.
                </p>
                
                <h2>Feature 3</h2>
                
                <p>
                  Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.
                <br id="feature4">
             Lorem ipsum dolor sit amet, consectetur adipiscing elit.
                </p>
                
                <h2>Feature 4</h2>
                
                <p>
                  Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.
                  <br>
                  <br>
                  Lorem ipsum dolor sit amet, consectetur adipiscing elit.
                 <br>
                 <br id="feature5">
                 Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.
                </p>
                
                
                <h2>Feature 5</h2>
                
                <p>
                Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. 
                <br>
                <br>
                Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.
                <br>
                </p>
                
        
                
               <h2>Feature 5</h2>
                 
               <p>
                Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. 
                <br id="advanced">
                Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.
                </p>
                
                <div class="divider" style="width:24%; margin:30px 0;"></div>
                
                <h1>Advanced Features</h1>
                
                <h2>Feature A</h2>
                
                <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. 
                Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor 
                in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. 
                <br>
                <br id="featureb">
                Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.</p>
                   
                
                <h2>Feature B</h2>
                
                <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.
                <br>
                <br id="featurec">
                Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.</p>
                
                
                <h2>Feature C</h2>
                  
                <p id="featurec1">Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.</p>
                  
                 
                <h2>Feature C.1</h2>

                <p>
                    Lorem ipsum dolor sit amet, consectetur adipiscing elit:
                </p>
                
                   <ul>
                    <li>
                    <b>Point 1</b> Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.
                    <br>
                    <li>
                    <b>Point 2</b> Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor.
                    </li>
                    <br id="featurec2">
                     <li>
                    <b>Point 3</b> Lorem ipsum dolor sit amet, consectetur adipiscing elit.
                    <br>
                </ul>
                   
                 <h2>Feauture C.2</h2>
                   
                 <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.
                    <br>
                    <br>
                     <b>Important:</b> Please notice that lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.
                    <br>
                    <br>
                    Lorem ipsum dolor sit amet, consectetur adipiscing elit.
                 </p>
                  
                  
                  <h2>Feature D</h2>
                  
                  <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.
                  
                  <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.
                  <br>
                  <br id="accesibility">
                Lorem ipsum dolor sit amet, consectetur adipiscing elit.</p>
                  
                  
                <div class="divider" style="width:24%; margin:30px 0;"></div>
                   
                   <h1>Accessibility</h1>
                   
                   <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.
                   <br>
                   <br>
                   Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.
                   <br>
                   Lorem ipsum dolor sit amet, consectetur adipiscing elit.</p>
                   
                   <p>Lorem ipsum dolor sit amet.
                      <br id="moreinfo">Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.</p>
                   
                <div class="divider" style="width:24%; margin:30px 0;"></div>

                <h1>More Info</h1>

                <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.marks are protected by intellectual property rights.</p>

                <div class="doublespace"></div>
                <div class="divider" style="width:24%; margin:30px 0;"></div>
                

            </div>

        </div>


    </div>


</body>

</html>